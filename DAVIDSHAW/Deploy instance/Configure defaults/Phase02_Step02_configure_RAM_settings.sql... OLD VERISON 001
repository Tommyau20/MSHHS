-- At the time of writing this script, it is allowing for 2GB of the total RAM not to be configuraed for MSSQL.
-- i.e.  For 16 GB total RAM, the min RAM seeting for MSSQL will be 2GB and the max RAM setting will be 14GB.
-- All RAM configurations should be eveluated based on what other applications/services are being services by 
-- the servers along with MSSQL.

DECLARE @total_os_RAM int
DECLARE @max_SQL_RAM int
SELECT @total_os_RAM = [total_physical_memory_kb] from sys.dm_os_sys_memory
SET @max_SQL_RAM = (@total_os_RAM - 2097152)/(1024^2)
EXEC master.sys.sp_configure N'max server memory (MB)', @max_SQL_RAM
GO
RECONFIGURE WITH OVERRIDE
GO



DECLARE @total_os_RAM int
DECLARE @min_SQL_RAM int
SELECT @total_os_RAM = [total_physical_memory_kb] from sys.dm_os_sys_memory
IF @total_os_RAM > 10000000
	BEGIN
	SET @min_SQL_RAM = 4194304/(1024^2)
	EXEC master.sys.sp_configure N'min server memory (MB)', @min_SQL_RAM
	RECONFIGURE WITH OVERRIDE
	END
ELSE
	BEGIN
	SET @min_SQL_RAM = 2097152/(1024^2)
	EXEC master.sys.sp_configure N'min server memory (MB)', @min_SQL_RAM
	RECONFIGURE WITH OVERRIDE
	END